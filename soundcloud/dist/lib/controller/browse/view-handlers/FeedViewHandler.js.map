{"version":3,"file":"FeedViewHandler.js","sourceRoot":"","sources":["../../../../../src/lib/controller/browse/view-handlers/FeedViewHandler.ts"],"names":[],"mappings":";;;;;;;;;;;AAAA,mFAA4C;AAI5C,0CAA2C;AAE3C,wEAAgD;AAEhD,2CAA2C;AAM3C,MAAqB,eAAgB,SAAQ,yBAAyB;IAAtE;;;IAqCA,CAAC;IAnCC,KAAK,CAAC,MAAM;QACV,MAAM,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,WAAW,CAAC;QACrC,MAAM,SAAS,GAAG,OAAO,EAAE,SAAS,CAAC;QACrC,MAAM,UAAU,GAAG,OAAO,EAAE,UAAU,CAAC;QACvC,MAAM,WAAW,GAAgC,EAAE,aAAa,EAAE,CAAC,WAAW,EAAE,aAAa,CAAC,EAAE,CAAC;QAEjG,IAAI,SAAS,EAAE,CAAC;YACd,WAAW,CAAC,SAAS,GAAG,OAAO,CAAC,SAAS,CAAC;QAC5C,CAAC;QACD,IAAI,UAAU,EAAE,CAAC;YACf,WAAW,CAAC,UAAU,GAAG,OAAO,CAAC,UAAU,CAAC;QAC9C,CAAC;QACD,WAAW,CAAC,KAAK,GAAG,2BAAE,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC;QAEtD,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,QAAQ,CAAC,iBAAS,CAAC,IAAI,CAAC,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;QAC5E,MAAM,IAAI,GAAG,IAAI,CAAC,4BAA4B,CAAC,KAAK,EAAE;YACpD,WAAW,EAAE,uBAAA,IAAI,gEAAa,CAAC,IAAI,CAAC,IAAI,CAAC;YACzC,KAAK,EAAE,2BAAE,CAAC,OAAO,CAAC,4BAA4B,CAAC;SAChD,CAAC,CAAC;QAEH,OAAO,IAAI,CAAC;IACd,CAAC;CAcF;iHAZc,IAAgD;IAC3D,IAAI,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,CAAC;QAC1B,OAAO,IAAI,CAAC,WAAW,CAAC,wBAAY,CAAC,KAAK,CAAC,CAAC;IAC9C,CAAC;SACI,IAAI,IAAI,CAAC,IAAI,KAAK,UAAU,IAAI,IAAI,CAAC,IAAI,KAAK,iBAAiB,EAAE,CAAC;QACrE,OAAO,IAAI,CAAC,WAAW,CAAC,wBAAY,CAAC,QAAQ,CAAC,CAAC;IACjD,CAAC;SACI,IAAI,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,CAAC;QAC/B,OAAO,IAAI,CAAC,WAAW,CAAC,wBAAY,CAAC,KAAK,CAAC,CAAC;IAC9C,CAAC;IACD,OAAO,IAAI,CAAC;AACd,CAAC;kBApCkB,eAAe","sourcesContent":["import sc from '../../../SoundCloudContext';\nimport type AlbumEntity from '../../../entities/AlbumEntity';\nimport type PlaylistEntity from '../../../entities/PlaylistEntity';\nimport type TrackEntity from '../../../entities/TrackEntity';\nimport { ModelType } from '../../../model';\nimport { type FeedModelGetFeedItemsParams } from '../../../model/FeedModel';\nimport BaseViewHandler from './BaseViewHandler';\nimport type View from './View';\nimport { RendererType } from './renderers';\n\nexport interface FeedView extends View {\n  name: 'feed';\n}\n\nexport default class FeedViewHandler extends BaseViewHandler<FeedView> {\n\n  async browse() {\n    const { pageRef } = this.currentView;\n    const pageToken = pageRef?.pageToken;\n    const pageOffset = pageRef?.pageOffset;\n    const modelParams: FeedModelGetFeedItemsParams = { activityTypes: ['TrackPost', 'TrackRepost'] };\n\n    if (pageToken) {\n      modelParams.pageToken = pageRef.pageToken;\n    }\n    if (pageOffset) {\n      modelParams.pageOffset = pageRef.pageOffset;\n    }\n    modelParams.limit = sc.getConfigValue('itemsPerPage');\n\n    const items = await this.getModel(ModelType.Feed).getFeedItems(modelParams);\n    const page = this.buildPageFromLoopFetchResult(items, {\n      getRenderer: this.#getRenderer.bind(this),\n      title: sc.getI18n('SOUNDCLOUD_LIST_TITLE_FEED')\n    });\n\n    return page;\n  }\n\n  #getRenderer(item: AlbumEntity | PlaylistEntity | TrackEntity) {\n    if (item.type === 'album') {\n      return this.getRenderer(RendererType.Album);\n    }\n    else if (item.type === 'playlist' || item.type === 'system-playlist') {\n      return this.getRenderer(RendererType.Playlist);\n    }\n    else if (item.type === 'track') {\n      return this.getRenderer(RendererType.Track);\n    }\n    return null;\n  }\n}\n"]}